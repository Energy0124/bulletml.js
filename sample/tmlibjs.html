<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset=UTF-8>
</head>
<body>

<canvas id="app"></canvas>

<script src="../lib/tmlib.js"></script>
<script src="../build/bulletml.min.js"></script>
<script src="../build/plugins/tmlib.bulletml.js"></script>
<script>

tm.import("display");
tm.import("ui");

var app;
tm.main(function() {
    app = CanvasApp("#app").resize(200, 250).fitWindow();
    app.replaceScene(LoadingScene({
        width: 200,
        height: 250,
        assets: {
            "chara5": "../lib/chara5.png",
            "chara6": "../lib/chara6.png",
        },
        nextScene: MainScene
    }));
    app.run();
});

tm.define("MainScene", {
    superClass: "tm.app.Scene",

    init: function() {
        this.superInit();

        this.fromJSON({
            children: {
                enemy: {
                    type: "Sprite",
                    init: ["chara6", 32, 32],
                    frameIndex: 3,
                    x: 100,
                    y: 50,
                },
                player: {
                    type: "Player",
                    frameIndex: 27,
                    x: 100,
                    y: 200,
                },
            },
        });
    },
});

tm.define("Player", {
    superClass: "Sprite",
    init: function() {
        this.superInit("chara5", 32, 32);

        this.speed = 6;
    },
    update: function(app) {
        var kb = app.keyboard;
        if (kb.getKey("z")) {
            this.speed = 3;
        } else {
            this.speed = 6;
        }

        this.position.add(kb.getKeyDirection().mul(this.speed));
    },
});
</script>

</body>
</html>